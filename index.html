<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>App con Login e Mappa 3D</title>
  
  <!-- Mapbox GL JS -->
  <link href="https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.css" rel="stylesheet" />
  <script src="https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.js"></script>

  <!-- THREE.js (versione compatibile con Threebox 2.2.x) -->
  <script src="https://unpkg.com/three@0.122.0/build/three.min.js"></script>

  <!-- Threebox -->
  <link href="https://cdn.jsdelivr.net/gh/jscastro76/threebox@v.2.2.2/dist/threebox.css" rel="stylesheet" />
  <script src="https://cdn.jsdelivr.net/gh/jscastro76/threebox@v.2.2.2/dist/threebox.min.js"></script>
  
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: #f5f5f5;
      overflow: hidden;
    }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       SCHERMATA LOGIN
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    #loginScreen {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 9999;
      transition: opacity 0.5s ease, transform 0.5s ease;
    }

    #loginScreen.hidden {
      opacity: 0;
      transform: scale(0.95);
      pointer-events: none;
    }

    .login-container {
      background: white;
      padding: 40px;
      border-radius: 20px;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
      width: 90%;
      max-width: 500px; /* ğŸ†• Aumentato per form registrazione */
      animation: slideUp 0.5s ease;
      max-height: 90vh; /* ğŸ†• Per scroll su mobile */
      overflow-y: auto; /* ğŸ†• Scroll se contenuto troppo alto */
    }

    @keyframes slideUp {
      from {
        opacity: 0;
        transform: translateY(30px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .login-header {
      text-align: center;
      margin-bottom: 30px;
    }

    .login-header h1 {
      color: #333;
      font-size: 28px;
      margin-bottom: 10px;
    }

    .login-header p {
      color: #666;
      font-size: 14px;
    }

    .form-group {
      margin-bottom: 20px;
    }

    .form-group label {
      display: block;
      margin-bottom: 8px;
      color: #333;
      font-weight: 500;
      font-size: 14px;
    }

    .form-group input {
      width: 100%;
      padding: 12px 15px;
      border: 2px solid #e0e0e0;
      border-radius: 10px;
      font-size: 16px;
      transition: border-color 0.3s;
    }

    .form-group input:focus {
      outline: none;
      border-color: #667eea;
    }

    .login-button {
      width: 100%;
      padding: 14px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border: none;
      border-radius: 10px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: transform 0.2s, box-shadow 0.2s;
    }

    .login-button:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 20px rgba(102, 126, 234, 0.4);
    }

    .login-button:active {
      transform: translateY(0);
    }

    .error-message {
      color: #e74c3c;
      font-size: 14px;
      margin-top: 10px;
      text-align: center;
      display: none;
      animation: shake 0.5s;
    }

    @keyframes shake {
      0%, 100% { transform: translateX(0); }
      25% { transform: translateX(-10px); }
      75% { transform: translateX(10px); }
    }

    .error-message.show {
      display: block;
    }

    /* Form row per campi affiancati */
    .form-row {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 15px;
      margin-bottom: 20px;
    }

    .form-row .form-group {
      margin-bottom: 0;
    }

    /* Select styling */
    .form-group select {
      width: 100%;
      padding: 12px 15px;
      border: 2px solid #e0e0e0;
      border-radius: 10px;
      font-size: 16px;
      transition: border-color 0.3s;
      background: white;
      cursor: pointer;
      font-family: inherit;
    }

    .form-group select:focus {
      outline: none;
      border-color: #667eea;
    }

    /* Color palette */
    .color-palette {
      display: grid;
      grid-template-columns: repeat(6, 1fr);
      gap: 10px;
      margin-bottom: 15px;
    }

    .color-option {
      width: 100%;
      aspect-ratio: 1;
      border-radius: 50%;
      cursor: pointer;
      transition: all 0.3s;
      border: 3px solid transparent;
      position: relative;
    }

    .color-option:hover {
      transform: scale(1.1);
      box-shadow: 0 4px 12px rgba(0,0,0,0.2);
    }

    .color-option.selected {
      border-color: white;
      box-shadow: 0 0 0 3px currentColor, 0 4px 12px rgba(0,0,0,0.3);
      transform: scale(1.15);
    }

    .color-option.selected::after {
      content: 'âœ“';
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      color: white;
      font-size: 20px;
      font-weight: bold;
      text-shadow: 0 1px 3px rgba(0,0,0,0.5);
    }

    /* Avatar preview */
    .avatar-preview {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 10px;
      padding: 20px;
      background: #f8f9fa;
      border-radius: 10px;
      margin-top: 10px;
    }

    .preview-icon {
      width: 80px;
      height: 80px;
      background: #ccc;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-weight: bold;
      font-size: 36px;
      transition: all 0.3s;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }

    .avatar-preview p {
      margin: 0;
      color: #666;
      font-size: 14px;
    }

    /* Toggle form link */
    .toggle-form {
      margin-top: 20px;
      text-align: center;
      font-size: 14px;
      color: #666;
    }

    .toggle-form a {
      color: #667eea;
      text-decoration: none;
      font-weight: 600;
      transition: color 0.3s;
    }

    .toggle-form a:hover {
      color: #764ba2;
      text-decoration: underline;
    }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       SCHERMATA PRINCIPALE (Mappa 3D)
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    #mainScreen {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      display: none;
    }

    #mainScreen.active {
      display: block;
    }

    /* Mappa Mapbox */
    #map {
      position: absolute;
      inset: 0;
      width: 100%;
      height: 100%;
    }

    /* Loading overlay mappa */
    .loading-overlay-map {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0,0,0,0.7);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 9999;
      backdrop-filter: blur(4px);
    }
    
    .loading-overlay-map.active {
      display: flex;
    }

    /* Status indicator mappa */
    .status-indicator-map {
      position: absolute;
      top: 70px;
      right: 20px;
      background: rgba(0,0,0,.85);
      color: #fff;
      padding: 12px 16px;
      border-radius: 10px;
      font-size: 13px;
      z-index: 1000;
      max-width: 260px;
      transition: opacity 0.3s ease;
    }

    /* GPS controls mappa */
    .gps-controls-map {
      position: absolute;
      top: 90px;
      left: 20px;
      display: flex;
      flex-direction: column;
      gap: 10px;
      z-index: 1000;
    }

    .gps-controls-map button {
      background: rgba(255,255,255,.9);
      border: none;
      padding: 10px 16px;
      border-radius: 10px;
      cursor: pointer;
      box-shadow: 0 2px 6px rgba(0,0,0,.2);
      font-size: 14px;
      transition: all 0.2s;
      font-family: var(--font);
    }

    .gps-controls-map button:hover {
      transform: translateX(2px);
      box-shadow: 0 3px 8px rgba(0,0,0,.3);
    }

    .gps-button.active {
      background: #4CAF50;
      color: #fff;
    }

    .visibility-button.hidden {
      background: #ff9800;
      color: #fff;
    }

    /* Top right controls mappa */
    .top-right-controls-map {
      position: absolute;
      top: 20px;
      right: 20px;
      display: flex;
      gap: 10px;
      align-items: center;
      z-index: 1000;
      flex-wrap: wrap;
      justify-content: flex-end;
    }

    .top-right-controls-map button {
      background: white;
      border: none;
      padding: 10px 16px;
      font-size: 14px;
      border-radius: 10px;
      box-shadow: 0 2px 6px rgba(0,0,0,.2);
      cursor: pointer;
      transition: all 0.2s;
      font-family: var(--font);
    }

    .top-right-controls-map button:hover {
      transform: translateY(-1px);
      box-shadow: 0 3px 8px rgba(0,0,0,.25);
    }

    .direction-indicator-map {
      background: rgba(0,0,0,.7);
      color: #fff;
      padding: 10px 16px;
      border-radius: 20px;
      font-size: 14px;
      font-weight: 600;
      backdrop-filter: blur(8px);
    }

    .home-button-map {
      background: white;
    }

    /* Debug info mappa */
    .debug-info-map {
      position: absolute;
      bottom: 20px;
      left: 20px;
      background: rgba(0,0,0,.85);
      color: #fff;
      padding: 12px;
      border-radius: 10px;
      font-family: ui-monospace, SFMono-Regular, Menlo, monospace;
      font-size: 12px;
      max-width: 320px;
      z-index: 1000;
      white-space: pre-line;
    }

    /* Performance indicator mappa */
    .performance-indicator-map {
      position: absolute;
      bottom: 20px;
      right: 20px;
      background: rgba(0,0,0,.85);
      color: #fff;
      padding: 8px 12px;
      border-radius: 8px;
      font-size: 11px;
      font-family: monospace;
      z-index: 1000;
      display: none;
    }

    .performance-indicator-map.show {
      display: block;
    }

    /* Zoom controls mappa */
    .custom-controls-map {
      position: absolute;
      bottom: 20px;
      right: 50px;
      display: flex;
      gap: 8px;
      align-items: center;
      background: rgba(255,255,255,.9);
      padding: 8px;
      border-radius: 12px;
      box-shadow: 0 2px 6px rgba(0,0,0,.2);
      z-index: 1000;
    }

    .custom-controls-map button {
      font-size: 18px;
      padding: 4px 10px;
      border: none;
      background: white;
      border-radius: 8px;
      cursor: pointer;
      transition: background 0.2s;
      font-family: var(--font);
    }

    .custom-controls-map button:hover {
      background: #f0f0f0;
    }

    .pitch-slider {
      width: 60px;
      cursor: pointer;
    }

    /* Avatar marker */
    .avatar-marker {
      background-image: url('https://cdn-icons-png.flaticon.com/512/149/149071.png');
      background-size: cover;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      border: 2px solid #fff;
      box-shadow: 0 2px 6px rgba(0,0,0,.2);
      transition: opacity 0.3s ease, transform 0.3s ease;
    }

    .avatar-marker.avatar-hidden {
      opacity: 0;
      transform: scale(0.8);
      pointer-events: none;
    }

    /* Pulsante hamburger (3 righe) in alto a sinistra */
    .hamburger-button {
      position: fixed;
      top: 20px;
      left: 20px;
      width: 50px;
      height: 50px;
      background: white;
      border: none;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      cursor: pointer;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 6px;
      transition: all 0.3s;
      z-index: 10000; /* Sopra tutti gli elementi della mappa */
    }

    .hamburger-button:hover {
      box-shadow: 0 6px 16px rgba(0, 0, 0, 0.15);
      transform: translateY(-2px);
    }

    .hamburger-line {
      width: 24px;
      height: 3px;
      background: #333;
      border-radius: 2px;
      transition: all 0.3s;
    }

    .hamburger-button:hover .hamburger-line {
      background: #667eea;
    }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       MENU LATERALE (Sidebar)
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    #sidebar {
      position: fixed;
      top: 0;
      left: -350px;
      width: 350px;
      height: 100%;
      background: white;
      box-shadow: 4px 0 20px rgba(0, 0, 0, 0.1);
      transition: left 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      z-index: 1000;
      overflow-y: auto;
    }

    #sidebar.open {
      left: 0;
    }

    /* Overlay scuro quando sidebar aperta */
    #overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.5);
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.4s;
      z-index: 999;
    }

    #overlay.active {
      opacity: 1;
      pointer-events: all;
    }

    /* Header sidebar con X */
    .sidebar-header {
      padding: 30px 25px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      position: relative;
    }

    .close-button {
      position: absolute;
      top: 20px;
      right: 20px;
      width: 35px;
      height: 35px;
      background: rgba(255, 255, 255, 0.2);
      border: none;
      border-radius: 8px;
      color: white;
      font-size: 24px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.3s;
    }

    .close-button:hover {
      background: rgba(255, 255, 255, 0.3);
      transform: rotate(90deg);
    }

    .sidebar-header h2 {
      font-size: 24px;
      margin-bottom: 5px;
    }

    .sidebar-header p {
      font-size: 14px;
      opacity: 0.9;
    }

    /* Sezione profilo */
    .profile-section {
      padding: 25px;
      border-bottom: 1px solid #e0e0e0;
    }

    .profile-section h3 {
      color: #333;
      font-size: 18px;
      margin-bottom: 15px;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .profile-icon {
      width: 40px;
      height: 40px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-weight: bold;
      font-size: 18px;
    }

    .profile-info {
      margin-top: 15px;
    }

    .profile-item {
      display: flex;
      justify-content: space-between;
      padding: 10px 0;
      color: #666;
      font-size: 14px;
    }

    .profile-item strong {
      color: #333;
    }

    /* Sezione impostazioni */
    .settings-section {
      padding: 25px;
    }

    .settings-section h3 {
      color: #333;
      font-size: 18px;
      margin-bottom: 15px;
    }

    .setting-item {
      padding: 15px;
      background: #f8f9fa;
      border-radius: 10px;
      margin-bottom: 10px;
      cursor: pointer;
      transition: all 0.3s;
      display: flex;
      align-items: center;
      gap: 15px;
    }

    .setting-item:hover {
      background: #e9ecef;
      transform: translateX(5px);
    }

    .setting-icon {
      width: 40px;
      height: 40px;
      background: white;
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 20px;
    }

    .setting-content {
      flex: 1;
    }

    .setting-content h4 {
      color: #333;
      font-size: 15px;
      margin-bottom: 3px;
    }

    .setting-content p {
      color: #666;
      font-size: 12px;
    }

    /* Pulsante logout */
    .logout-section {
      padding: 25px;
      border-top: 1px solid #e0e0e0;
    }

    .logout-button {
      width: 100%;
      padding: 14px;
      background: #e74c3c;
      color: white;
      border: none;
      border-radius: 10px;
      font-size: 15px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s;
    }

    .logout-button:hover {
      background: #c0392b;
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(231, 76, 60, 0.3);
    }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       RESPONSIVE - DIMENSIONI DINAMICHE PC/MOBILE
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    
    /* DESKTOP (oltre 1024px) */
    @media (min-width: 1025px) {
      .login-container {
        max-width: 450px;
        padding: 50px;
      }

      .login-header h1 {
        font-size: 32px;
      }

      #sidebar {
        width: 400px;
        left: -400px;
      }

      .hamburger-button {
        width: 55px;
        height: 55px;
        top: 25px;
        left: 25px;
      }

      .hamburger-line {
        width: 28px;
        height: 3px;
      }

      .sidebar-header {
        padding: 40px 30px;
      }

      .sidebar-header h2 {
        font-size: 28px;
      }

      .profile-section,
      .settings-section,
      .logout-section {
        padding: 30px;
      }

      .setting-item {
        padding: 18px;
      }

      .close-button {
        width: 40px;
        height: 40px;
        top: 25px;
        right: 25px;
      }
    }

    /* TABLET (768px - 1024px) */
    @media (min-width: 768px) and (max-width: 1024px) {
      .login-container {
        max-width: 420px;
        padding: 40px 35px;
      }

      .login-header h1 {
        font-size: 30px;
      }

      #sidebar {
        width: 380px;
        left: -380px;
      }

      .hamburger-button {
        width: 52px;
        height: 52px;
        top: 22px;
        left: 22px;
      }

      .hamburger-line {
        width: 26px;
      }

      .sidebar-header {
        padding: 35px 28px;
      }

      .sidebar-header h2 {
        font-size: 26px;
      }

      .profile-section,
      .settings-section,
      .logout-section {
        padding: 28px;
      }

      .setting-item {
        padding: 16px;
      }

      .close-button {
        width: 38px;
        height: 38px;
        top: 22px;
        right: 22px;
      }
    }

    /* MOBILE LANDSCAPE (481px - 767px) */
    @media (min-width: 481px) and (max-width: 767px) {
      .login-container {
        max-width: 400px;
        padding: 35px 25px;
      }

      .login-header h1 {
        font-size: 26px;
      }

      #sidebar {
        width: 85%;
        max-width: 350px;
        left: -85%;
      }

      .hamburger-button {
        width: 48px;
        height: 48px;
        top: 18px;
        left: 18px;
      }

      .hamburger-line {
        width: 24px;
      }

      .sidebar-header {
        padding: 30px 25px;
      }

      .sidebar-header h2 {
        font-size: 24px;
      }

      .profile-section,
      .settings-section,
      .logout-section {
        padding: 25px;
      }

      .setting-item {
        padding: 14px;
      }

      .setting-icon {
        width: 38px;
        height: 38px;
        font-size: 18px;
      }

      .close-button {
        width: 36px;
        height: 36px;
        top: 18px;
        right: 18px;
        font-size: 22px;
      }
    }

    /* MOBILE PORTRAIT (fino a 480px) */
    @media (max-width: 480px) {
      .login-container {
        width: 95%;
        max-width: 350px;
        padding: 30px 20px;
        max-height: 85vh; /* PiÃ¹ spazio su mobile */
      }

      .login-header h1 {
        font-size: 24px;
      }

      .login-header p {
        font-size: 13px;
      }

      .form-group label {
        font-size: 13px;
      }

      .form-group input {
        padding: 11px 13px;
        font-size: 15px;
      }

      .login-button {
        padding: 12px;
        font-size: 15px;
      }

      /* Form row stacked su mobile */
      .form-row {
        grid-template-columns: 1fr;
        gap: 0;
      }

      .form-row .form-group {
        margin-bottom: 20px;
      }

      /* Color palette piÃ¹ piccola */
      .color-palette {
        grid-template-columns: repeat(4, 1fr);
        gap: 8px;
      }

      .preview-icon {
        width: 60px;
        height: 60px;
        font-size: 28px;
      }

      /* Sidebar occupa tutta la larghezza su mobile piccolo */
      #sidebar {
        width: 100%;
        left: -100%;
      }

      .hamburger-button {
        width: 45px;
        height: 45px;
        top: 15px;
        left: 15px;
      }

      .hamburger-line {
        width: 22px;
        height: 2.5px;
        gap: 5px;
      }

      .sidebar-header {
        padding: 25px 20px;
      }

      .sidebar-header h2 {
        font-size: 22px;
      }

      .sidebar-header p {
        font-size: 13px;
      }

      .close-button {
        width: 34px;
        height: 34px;
        top: 15px;
        right: 15px;
        font-size: 20px;
      }

      .profile-section,
      .settings-section,
      .logout-section {
        padding: 20px;
      }

      .profile-section h3,
      .settings-section h3 {
        font-size: 16px;
      }

      .profile-icon {
        width: 36px;
        height: 36px;
        font-size: 16px;
      }

      .profile-item {
        font-size: 13px;
        padding: 8px 0;
      }

      .setting-item {
        padding: 12px;
        margin-bottom: 8px;
      }

      .setting-icon {
        width: 36px;
        height: 36px;
        font-size: 16px;
      }

      .setting-content h4 {
        font-size: 14px;
      }

      .setting-content p {
        font-size: 11px;
      }

      .logout-button {
        padding: 12px;
        font-size: 14px;
      }
      
      /* MAPPA - Mobile adjustments */
      .gps-controls-map {
        top: 15px;
        left: 15px;
        gap: 8px;
      }
      
      .gps-controls-map button {
        padding: 8px 12px;
        font-size: 12px;
      }
      
      .top-right-controls-map {
        top: 15px;
        right: 15px;
        gap: 8px;
      }
      
      .top-right-controls-map button {
        padding: 8px 12px;
        font-size: 12px;
      }
      
      .direction-indicator-map {
        padding: 8px 12px;
        font-size: 12px;
      }
      
      .status-indicator-map {
        top: 60px;
        right: 15px;
        padding: 10px 12px;
        font-size: 12px;
        max-width: 200px;
      }
      
      .debug-info-map {
        bottom: 15px;
        left: 15px;
        padding: 10px;
        font-size: 10px;
        max-width: 250px;
      }
      
      .custom-controls-map {
        bottom: 15px;
        right: 15px;
        padding: 6px;
        gap: 6px;
      }
      
      .custom-controls-map button {
        padding: 4px 8px;
        font-size: 16px;
      }
      
      .pitch-slider {
        width: 50px;
      }
      
      .performance-indicator-map {
        bottom: 15px;
        right: 15px;
        font-size: 10px;
        padding: 6px 10px;
      }
    }

    /* MOBILE MOLTO PICCOLO (fino a 360px) */
    @media (max-width: 360px) {
      .login-container {
        width: 98%;
        padding: 25px 15px;
      }

      .login-header h1 {
        font-size: 22px;
      }

      .hamburger-button {
        width: 42px;
        height: 42px;
        top: 12px;
        left: 12px;
      }

      .hamburger-line {
        width: 20px;
      }

      .sidebar-header {
        padding: 20px 15px;
      }

      .sidebar-header h2 {
        font-size: 20px;
      }

      .close-button {
        width: 32px;
        height: 32px;
        top: 12px;
        right: 12px;
        font-size: 18px;
      }

      .profile-section,
      .settings-section,
      .logout-section {
        padding: 15px;
      }

      .profile-section h3,
      .settings-section h3 {
        font-size: 15px;
      }

      .profile-icon {
        width: 32px;
        height: 32px;
        font-size: 14px;
      }

      .setting-item {
        padding: 10px;
        gap: 10px;
      }

      .setting-icon {
        width: 32px;
        height: 32px;
        font-size: 14px;
      }

      .setting-content h4 {
        font-size: 13px;
      }

      .setting-content p {
        font-size: 10px;
      }
    }

    /* LARGE DESKTOP (oltre 1440px) */
    @media (min-width: 1441px) {
      .login-container {
        max-width: 500px;
        padding: 60px;
      }

      .login-header h1 {
        font-size: 36px;
      }

      .login-header p {
        font-size: 16px;
      }

      .form-group label {
        font-size: 15px;
      }

      .form-group input {
        padding: 14px 16px;
        font-size: 17px;
      }

      .login-button {
        padding: 16px;
        font-size: 17px;
      }

      #sidebar {
        width: 450px;
        left: -450px;
      }

      .hamburger-button {
        width: 60px;
        height: 60px;
        top: 30px;
        left: 30px;
      }

      .hamburger-line {
        width: 30px;
        height: 4px;
      }

      .sidebar-header {
        padding: 45px 35px;
      }

      .sidebar-header h2 {
        font-size: 30px;
      }

      .sidebar-header p {
        font-size: 16px;
      }

      .close-button {
        width: 45px;
        height: 45px;
        top: 30px;
        right: 30px;
        font-size: 28px;
      }

      .profile-section,
      .settings-section,
      .logout-section {
        padding: 35px;
      }

      .profile-section h3,
      .settings-section h3 {
        font-size: 20px;
      }

      .profile-icon {
        width: 45px;
        height: 45px;
        font-size: 20px;
      }

      .profile-item {
        font-size: 15px;
        padding: 12px 0;
      }

      .setting-item {
        padding: 20px;
        margin-bottom: 12px;
      }

      .setting-icon {
        width: 45px;
        height: 45px;
        font-size: 22px;
      }

      .setting-content h4 {
        font-size: 16px;
      }

      .setting-content p {
        font-size: 13px;
      }

      .logout-button {
        padding: 16px;
        font-size: 16px;
      }
    }

    /* ORIENTAMENTO (Landscape su mobile) */
    @media (max-height: 500px) and (orientation: landscape) {
      .login-container {
        max-height: 90vh;
        overflow-y: auto;
        padding: 20px;
      }

      .login-header h1 {
        font-size: 20px;
        margin-bottom: 5px;
      }

      .login-header p {
        font-size: 12px;
      }

      .form-group {
        margin-bottom: 12px;
      }

      .form-group input {
        padding: 8px 12px;
      }

      .login-button {
        padding: 10px;
      }

      #sidebar {
        overflow-y: auto;
      }

      .sidebar-header {
        padding: 15px 20px;
      }

      .profile-section,
      .settings-section,
      .logout-section {
        padding: 15px 20px;
      }

      .setting-item {
        padding: 10px;
        margin-bottom: 6px;
      }
    }

    /* TOUCH DEVICES - Area tocco piÃ¹ grande */
    @media (hover: none) and (pointer: coarse) {
      .hamburger-button,
      .close-button,
      .setting-item {
        /* Aumenta area touch per dispositivi touch */
        min-height: 44px; /* Apple Human Interface Guidelines */
      }

      .login-button,
      .logout-button {
        min-height: 48px;
      }
    }
  </style>
</head>
<body>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       SCHERMATA LOGIN
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div id="loginScreen">
    <div class="login-container">
      <div class="login-header">
        <h1>ğŸš¶ğŸš¶ğŸ½â€â™€ï¸â€â¡ï¸ Benvenuto su MeetGo</h1>
        <p id="loginSubtitle">Accedi per continuare</p>
      </div>
      
      <!-- FORM LOGIN -->
      <form id="loginForm">
        <div class="form-group">
          <label for="username">Username</label>
          <input 
            type="text" 
            id="username" 
            placeholder="Inserisci username"
            autocomplete="username"
            required
          >
        </div>
        <div class="form-group">
          <label for="password">Password</label>
          <input 
            type="password" 
            id="password" 
            placeholder="Inserisci password"
            autocomplete="current-password"
            required
          >
        </div>
        <button type="submit" class="login-button">Accedi</button>
        <div class="error-message" id="errorMessage">
          âŒ Username o password errati
        </div>
      </form>

      <!-- FORM REGISTRAZIONE (nascosto inizialmente) -->
      <form id="registerForm" style="display: none;">
        <div class="form-row">
          <div class="form-group">
            <label for="regNome">Nome *</label>
            <input 
              type="text" 
              id="regNome" 
              placeholder="Mario"
              required
            >
          </div>
          <div class="form-group">
            <label for="regCognome">Cognome *</label>
            <input 
              type="text" 
              id="regCognome" 
              placeholder="Rossi"
              required
            >
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label for="regDataNascita">Data di Nascita *</label>
            <input 
              type="date" 
              id="regDataNascita" 
              required
            >
          </div>
          <div class="form-group">
            <label for="regSesso">Sesso *</label>
            <select id="regSesso" required>
              <option value="">Seleziona</option>
              <option value="M">Maschio</option>
              <option value="F">Femmina</option>
              <option value="Altro">Altro</option>
            </select>
          </div>
        </div>

        <div class="form-group">
          <label for="regEmail">Email *</label>
          <input 
            type="email" 
            id="regEmail" 
            placeholder="mario.rossi@example.com"
            required
          >
        </div>

        <div class="form-group">
          <label for="regUsername">Username *</label>
          <input 
            type="text" 
            id="regUsername" 
            placeholder="mario_rossi"
            required
          >
        </div>

        <div class="form-group">
          <label for="regPassword">Password *</label>
          <input 
            type="password" 
            id="regPassword" 
            placeholder="Minimo 6 caratteri"
            minlength="6"
            required
          >
        </div>

        <div class="form-group">
          <label for="regPasswordConfirm">Conferma Password *</label>
          <input 
            type="password" 
            id="regPasswordConfirm" 
            placeholder="Ripeti password"
            minlength="6"
            required
          >
        </div>

        <div class="form-group">
          <label>Colore Avatar *</label>
          <div class="color-palette" id="colorPalette">
            <div class="color-option" data-color="#667eea" style="background: #667eea"></div>
            <div class="color-option" data-color="#e74c3c" style="background: #e74c3c"></div>
            <div class="color-option" data-color="#3498db" style="background: #3498db"></div>
            <div class="color-option" data-color="#2ecc71" style="background: #2ecc71"></div>
            <div class="color-option" data-color="#f39c12" style="background: #f39c12"></div>
            <div class="color-option" data-color="#9b59b6" style="background: #9b59b6"></div>
            <div class="color-option" data-color="#1abc9c" style="background: #1abc9c"></div>
            <div class="color-option" data-color="#e91e63" style="background: #e91e63"></div>
            <div class="color-option" data-color="#ff5722" style="background: #ff5722"></div>
            <div class="color-option" data-color="#795548" style="background: #795548"></div>
            <div class="color-option" data-color="#607d8b" style="background: #607d8b"></div>
            <div class="color-option" data-color="#ff9800" style="background: #ff9800"></div>
          </div>
          <input type="hidden" id="selectedColor" required>
          <div class="avatar-preview" id="avatarPreview">
            <div class="preview-icon" id="previewIcon">?</div>
            <p>Anteprima Avatar</p>
          </div>
        </div>

        <button type="submit" class="login-button">Registrati</button>
        <div class="error-message" id="registerError">
          âŒ Errore nella registrazione
        </div>
      </form>

      <!-- Toggle Login/Registrazione -->
      <div class="toggle-form">
        <p id="toggleText">Non hai un account? <a href="#" id="toggleLink">Registrati</a></p>
      </div>
      
      <div style="margin-top: 20px; text-align: center; font-size: 12px; color: #999;">
        ğŸ’¡ <strong>Account demo:</strong><br>
        ğŸ‘¤ user / user123<br>
        ğŸ‘¤ admin / admin123
      </div>
    </div>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       SCHERMATA PRINCIPALE (Mappa 3D)
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div id="mainScreen">
    <!-- Mappa Mapbox -->
    <div id="map"></div>

    <!-- Loading overlay per avatar -->
    <div class="loading-overlay-map" id="loadingOverlay">
      <div class="loading-content">
        <div class="spinner"></div>
        <div class="loading-text" id="loadingText">Caricamento avatar...</div>
        <div class="loading-progress" id="loadingProgress">0%</div>
      </div>
    </div>

    <!-- Status indicator -->
    <div class="status-indicator-map" id="statusIndicator">Caricamentoâ€¦</div>

    <!-- GPS controls -->
    <div class="gps-controls-map">
      <button class="gps-button active" id="gpsToggle">ğŸ“ GPS ON</button>
      <button class="visibility-button" id="visibilityToggle">ğŸ‘ï¸ Avatar ON</button>
    </div>

    <!-- Top right controls -->
    <div class="top-right-controls-map">
      <button class="avatar-toggle" id="avatarToggle">ğŸ‘¤ 3D</button>
      <button class="avatar-toggle" id="buildingsToggle">ğŸ™ï¸ 3D On</button>
      <button class="home-button-map" id="goHome">ğŸ </button>
      <div class="direction-indicator-map" id="directionIndicator">N 0Â°</div>
    </div>

    <!-- Debug info -->
    <div class="debug-info-map" id="debugInfo">Debug GPS: Caricamentoâ€¦</div>

    <!-- Performance monitor -->
    <div class="performance-indicator-map" id="performanceIndicator">
      FPS: 60 | Mem: 0 MB
    </div>

    <!-- Zoom controls -->
    <div class="custom-controls-map">
      <button id="zoomIn">+</button>
      <button id="zoomOut">âˆ’</button>
      <input type="range" id="pitchSlider" min="0" max="85" value="60" class="pitch-slider">
    </div>
    
    <!-- Pulsante hamburger (3 righe) -->
    <button class="hamburger-button" id="hamburgerButton">
      <div class="hamburger-line"></div>
      <div class="hamburger-line"></div>
      <div class="hamburger-line"></div>
    </button>
  </div>

  <!-- Overlay scuro -->
  <div id="overlay"></div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       SIDEBAR (Menu laterale)
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div id="sidebar">
    <!-- Header con X -->
    <div class="sidebar-header">
      <button class="close-button" id="closeButton">Ã—</button>
      <h2>Menu</h2>
      <p>Gestisci il tuo profilo</p>
    </div>

    <!-- Sezione Profilo -->
    <div class="profile-section">
      <h3>
        <div class="profile-icon">U</div>
        Il Tuo Profilo
      </h3>
      <div class="profile-info">
        <!-- VerrÃ  popolato dinamicamente al login -->
        <div class="profile-item">
          <span>Username:</span>
          <strong id="profileUsername">user</strong>
        </div>
        <div class="profile-item">
          <span>Ruolo:</span>
          <strong>Utente Standard</strong>
        </div>
        <div class="profile-item">
          <span>Ultimo accesso:</span>
          <strong id="lastLogin">--</strong>
        </div>
      </div>
    </div>

    <!-- Sezione Impostazioni -->
    <div class="settings-section">
      <h3>âš™ï¸ Impostazioni</h3>
      
      <div class="setting-item" onclick="alert('Funzione Profilo in arrivo!')">
        <div class="setting-icon">ğŸ‘¤</div>
        <div class="setting-content">
          <h4>Modifica Profilo</h4>
          <p>Cambia foto e informazioni</p>
        </div>
      </div>

      <div class="setting-item" onclick="alert('Funzione Notifiche in arrivo!')">
        <div class="setting-icon">ğŸ””</div>
        <div class="setting-content">
          <h4>Notifiche</h4>
          <p>Gestisci le tue notifiche</p>
        </div>
      </div>

      <div class="setting-item" onclick="alert('Funzione Sicurezza in arrivo!')">
        <div class="setting-icon">ğŸ”’</div>
        <div class="setting-content">
          <h4>Sicurezza</h4>
          <p>Cambia password e privacy</p>
        </div>
      </div>

      <div class="setting-item" onclick="alert('Funzione Tema in arrivo!')">
        <div class="setting-icon">ğŸ¨</div>
        <div class="setting-content">
          <h4>Aspetto</h4>
          <p>Tema e personalizzazione</p>
        </div>
      </div>

      <div class="setting-item" onclick="alert('Funzione Aiuto in arrivo!')">
        <div class="setting-icon">â“</div>
        <div class="setting-content">
          <h4>Aiuto</h4>
          <p>FAQ e supporto</p>
        </div>
      </div>

      <div class="setting-item" onclick="showStorageInfo()">
        <div class="setting-icon">ğŸ’¾</div>
        <div class="setting-content">
          <h4>Storage</h4>
          <p>Info account salvati</p>
        </div>
      </div>
    </div>

    <!-- Pulsante Logout -->
    <div class="logout-section">
      <button class="logout-button" id="logoutButton">
        ğŸšª Esci dall'account
      </button>
    </div>
  </div>

  <script>
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // ğŸ†• SISTEMA MULTI-ACCOUNT CON LOCALSTORAGE PERSISTENTE
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    // Chiave per localStorage
    const STORAGE_KEY = 'app_accounts_database';

    // Carica account da localStorage o usa default
    function loadAccountsFromStorage() {
      const stored = localStorage.getItem(STORAGE_KEY);
      if (stored) {
        try {
          const accounts = JSON.parse(stored);
          console.log('ğŸ“¦ Caricati', accounts.length, 'account da localStorage');
          return accounts;
        } catch (e) {
          console.error('âŒ Errore nel parsing degli account:', e);
          return getDefaultAccounts();
        }
      } else {
        console.log('ğŸ†• Nessun account salvato, uso account default');
        return getDefaultAccounts();
      }
    }

    // Account predefiniti (solo la prima volta)
    function getDefaultAccounts() {
      return [
        {
          id: 1,
          username: 'user',
          password: 'user123',
          nome: 'Mario Rossi',
          email: 'mario.rossi@example.com',
          ruolo: 'Utente Standard',
          avatar: 'M',
          colore: '#667eea',
          dataRegistrazione: '2024-01-15'
        },
        {
          id: 2,
          username: 'admin',
          password: 'admin123',
          nome: 'Admin Sistema',
          email: 'admin@example.com',
          ruolo: 'Amministratore',
          avatar: 'A',
          colore: '#e74c3c',
          dataRegistrazione: '2023-12-01'
        }
      ];
    }

    // Salva account in localStorage
    function saveAccountsToStorage() {
      try {
        localStorage.setItem(STORAGE_KEY, JSON.stringify(ACCOUNTS_DATABASE));
        console.log('ğŸ’¾ Account salvati in localStorage');
        return true;
      } catch (e) {
        console.error('âŒ Errore nel salvataggio:', e);
        if (e.name === 'QuotaExceededError') {
          alert('âš ï¸ Memoria browser piena! Impossibile salvare.');
        }
        return false;
      }
    }

    // Database account (carica da localStorage)
    let ACCOUNTS_DATABASE = loadAccountsFromStorage();

    // Salva automaticamente ogni volta che il database cambia
    function updateDatabase() {
      saveAccountsToStorage();
    }

    // Account corrente loggato
    let currentUser = null;

    // Funzione per trovare account
    function findAccount(username, password) {
      return ACCOUNTS_DATABASE.find(
        account => account.username === username && account.password === password
      );
    }

    // Funzione per aggiungere nuovo account
    function addAccount(accountData) {
      const newAccount = {
        id: ACCOUNTS_DATABASE.length + 1,
        username: accountData.username,
        password: accountData.password,
        nome: accountData.nome || 'Nuovo Utente',
        email: accountData.email || '',
        ruolo: accountData.ruolo || 'Utente Standard',
        avatar: accountData.username.charAt(0).toUpperCase(),
        colore: accountData.colore || '#667eea',
        dataRegistrazione: new Date().toISOString().split('T')[0]
      };
      
      ACCOUNTS_DATABASE.push(newAccount);
      updateDatabase(); // ğŸ†• Salva in localStorage
      console.log('âœ… Account aggiunto e salvato:', newAccount.username);
      return newAccount;
    }

    // Funzione helper per vedere tutti gli account (solo console)
    window.showAccounts = function() {
      console.table(ACCOUNTS_DATABASE.map(acc => ({
        Username: acc.username,
        Password: acc.password,
        Nome: acc.nome,
        Ruolo: acc.ruolo,
        Email: acc.email
      })));
    };

    // Funzione helper per aggiungere account dalla console
    window.createAccount = function(username, password, nome, email, ruolo) {
      if (!username || !password) {
        console.error('âŒ Username e password sono obbligatori');
        return;
      }
      
      // Verifica se username esiste giÃ 
      if (ACCOUNTS_DATABASE.find(acc => acc.username === username)) {
        console.error('âŒ Username giÃ  esistente');
        return;
      }
      
      const newAccount = addAccount({
        username,
        password,
        nome: nome || username,
        email: email || `${username}@example.com`,
        ruolo: ruolo || 'Utente Standard'
      });
      
      console.log('âœ… Account creato con successo!');
      console.log('ğŸ“‹ Dettagli:', newAccount);
      return newAccount;
    };

    // Funzione per cancellare tutti gli account (ATTENZIONE!)
    window.resetAccounts = function() {
      if (confirm('âš ï¸ ATTENZIONE: Vuoi eliminare TUTTI gli account e tornare ai default?')) {
        ACCOUNTS_DATABASE = getDefaultAccounts();
        updateDatabase();
        console.log('ğŸ”„ Database resettato agli account default');
        alert('âœ… Database resettato! Ricarica la pagina.');
      }
    };

    // Funzione per esportare database (backup)
    window.exportAccounts = function() {
      const dataStr = JSON.stringify(ACCOUNTS_DATABASE, null, 2);
      const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
      const exportFileDefaultName = `accounts_backup_${new Date().toISOString().split('T')[0]}.json`;
      
      const linkElement = document.createElement('a');
      linkElement.setAttribute('href', dataUri);
      linkElement.setAttribute('download', exportFileDefaultName);
      linkElement.click();
      
      console.log('ğŸ’¾ Database esportato come JSON');
    };

    // Funzione per vedere info storage
    window.storageInfo = function() {
      const stored = localStorage.getItem(STORAGE_KEY);
      const size = stored ? (new Blob([stored]).size / 1024).toFixed(2) : 0;
      const maxSize = 5120; // ~5MB limit
      const used = ((size / maxSize) * 100).toFixed(2);
      
      console.group('ğŸ’¾ Info LocalStorage');
      console.log('Accounts salvati:', ACCOUNTS_DATABASE.length);
      console.log('Dimensione:', size, 'KB');
      console.log('Spazio usato:', used, '%');
      console.log('Limite browser:', maxSize, 'KB (~5MB)');
      console.groupEnd();
    };

    // ğŸ†• Funzione per mostrare info storage con alert
    function showStorageInfo() {
      const stored = localStorage.getItem(STORAGE_KEY);
      const size = stored ? (new Blob([stored]).size / 1024).toFixed(2) : 0;
      const accountsCount = ACCOUNTS_DATABASE.length;
      
      const message = `ğŸ’¾ Info Archiviazione\n\n` +
                     `âœ… Account salvati: ${accountsCount}\n` +
                     `ğŸ“Š Dimensione: ${size} KB\n` +
                     `ğŸ”’ Salvati permanentemente nel browser\n\n` +
                     `ğŸ“ Gli account rimangono anche dopo la chiusura del browser!`;
      
      alert(message);
      console.log('ğŸ’¾ Storage info mostrate');
    }

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // ELEMENTI DOM
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    const loginScreen = document.getElementById('loginScreen');
    const mainScreen = document.getElementById('mainScreen');
    const loginForm = document.getElementById('loginForm');
    const registerForm = document.getElementById('registerForm');
    const errorMessage = document.getElementById('errorMessage');
    const registerError = document.getElementById('registerError');
    const hamburgerButton = document.getElementById('hamburgerButton');
    const sidebar = document.getElementById('sidebar');
    const overlay = document.getElementById('overlay');
    const closeButton = document.getElementById('closeButton');
    const logoutButton = document.getElementById('logoutButton');
    const profileUsername = document.getElementById('profileUsername');
    const toggleLink = document.getElementById('toggleLink');
    const toggleText = document.getElementById('toggleText');
    const loginSubtitle = document.getElementById('loginSubtitle');

    // Elementi registrazione
    let selectedColor = null;
    const colorOptions = document.querySelectorAll('.color-option');
    const previewIcon = document.getElementById('previewIcon');
    const avatarPreview = document.getElementById('avatarPreview');

    // TOGGLE TRA LOGIN E REGISTRAZIONE
    let isLoginMode = true;

    toggleLink.addEventListener('click', (e) => {
      e.preventDefault();
      isLoginMode = !isLoginMode;

      if (isLoginMode) {
        // Mostra form login
        loginForm.style.display = 'block';
        registerForm.style.display = 'none';
        loginSubtitle.textContent = 'Accedi per continuare';
        toggleText.innerHTML = 'Non hai un account? <a href="#" id="toggleLink">Registrati</a>';
        errorMessage.classList.remove('show');
        registerError.classList.remove('show');
      } else {
        // Mostra form registrazione
        loginForm.style.display = 'none';
        registerForm.style.display = 'block';
        loginSubtitle.textContent = 'Crea il tuo account';
        toggleText.innerHTML = 'Hai giÃ  un account? <a href="#" id="toggleLink">Accedi</a>';
        errorMessage.classList.remove('show');
        registerError.classList.remove('show');
      }

      // Ri-attacca evento al nuovo link
      document.getElementById('toggleLink').addEventListener('click', arguments.callee);
    });

    // GESTIONE SELEZIONE COLORE
    colorOptions.forEach(option => {
      option.addEventListener('click', function() {
        // Rimuovi selezione precedente
        colorOptions.forEach(opt => opt.classList.remove('selected'));
        
        // Aggiungi selezione corrente
        this.classList.add('selected');
        selectedColor = this.getAttribute('data-color');
        document.getElementById('selectedColor').value = selectedColor;
        
        // Aggiorna preview
        document.querySelector('.preview-icon').style.background = selectedColor;
        
        console.log('ğŸ¨ Colore selezionato:', selectedColor);
      });
    });

    // AGGIORNA PREVIEW AVATAR QUANDO SCRIVI USERNAME
    document.getElementById('regUsername').addEventListener('input', function(e) {
      const username = e.target.value;
      if (username.length > 0) {
        previewIcon.textContent = username.charAt(0).toUpperCase();
      } else {
        previewIcon.textContent = '?';
      }
    });

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // GESTIONE REGISTRAZIONE
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    registerForm.addEventListener('submit', (e) => {
      e.preventDefault();
      
      // Raccogli dati dal form
      const nome = document.getElementById('regNome').value.trim();
      const cognome = document.getElementById('regCognome').value.trim();
      const dataNascita = document.getElementById('regDataNascita').value;
      const sesso = document.getElementById('regSesso').value;
      const email = document.getElementById('regEmail').value.trim();
      const username = document.getElementById('regUsername').value.trim();
      const password = document.getElementById('regPassword').value;
      const passwordConfirm = document.getElementById('regPasswordConfirm').value;
      const colore = document.getElementById('selectedColor').value;

      // VALIDAZIONI
      
      // 1. Verifica che il colore sia stato selezionato
      if (!colore) {
        registerError.textContent = 'âŒ Seleziona un colore per l\'avatar';
        registerError.classList.add('show');
        setTimeout(() => registerError.classList.remove('show'), 3000);
        return;
      }

      // 2. Verifica che le password coincidano
      if (password !== passwordConfirm) {
        registerError.textContent = 'âŒ Le password non coincidono';
        registerError.classList.add('show');
        setTimeout(() => registerError.classList.remove('show'), 3000);
        return;
      }

      // 3. Verifica che username non esista giÃ 
      if (ACCOUNTS_DATABASE.find(acc => acc.username === username)) {
        registerError.textContent = 'âŒ Username giÃ  esistente';
        registerError.classList.add('show');
        setTimeout(() => registerError.classList.remove('show'), 3000);
        return;
      }

      // 4. Verifica che email non esista giÃ 
      if (ACCOUNTS_DATABASE.find(acc => acc.email === email)) {
        registerError.textContent = 'âŒ Email giÃ  registrata';
        registerError.classList.add('show');
        setTimeout(() => registerError.classList.remove('show'), 3000);
        return;
      }

      // 5. Verifica etÃ  minima (13 anni)
      const birthDate = new Date(dataNascita);
      const today = new Date();
      const age = today.getFullYear() - birthDate.getFullYear();
      if (age < 13) {
        registerError.textContent = 'âŒ Devi avere almeno 13 anni';
        registerError.classList.add('show');
        setTimeout(() => registerError.classList.remove('show'), 3000);
        return;
      }

      // CREA NUOVO ACCOUNT
      const newAccount = {
        id: ACCOUNTS_DATABASE.length + 1,
        username: username,
        password: password,
        nome: `${nome} ${cognome}`,
        email: email,
        ruolo: 'Utente Standard',
        avatar: username.charAt(0).toUpperCase(),
        colore: colore,
        dataRegistrazione: new Date().toISOString().split('T')[0],
        // ğŸ†• Dati aggiuntivi
        dataNascita: dataNascita,
        sesso: sesso,
        nomeCompleto: {
          nome: nome,
          cognome: cognome
        }
      };

      // Aggiungi al database
      ACCOUNTS_DATABASE.push(newAccount);
      updateDatabase(); // ğŸ†• SALVA PERMANENTEMENTE

      console.log('âœ… Nuovo account creato e salvato:', newAccount.username);
      console.log('ğŸ“‹ Dettagli:', newAccount);
      console.log('ğŸ’¾ Salvato in localStorage permanentemente');

      // SUCCESSO - Mostra messaggio e passa a login
      registerError.style.background = '#4CAF50';
      registerError.style.color = 'white';
      registerError.textContent = 'âœ… Account creato con successo! Accedi ora';
      registerError.classList.add('show');

      // Reset form
      registerForm.reset();
      selectedColor = null;
      colorOptions.forEach(opt => opt.classList.remove('selected'));
      previewIcon.style.background = '#ccc';
      previewIcon.textContent = '?';

      // Torna a login dopo 2 secondi
      setTimeout(() => {
        registerError.classList.remove('show');
        registerError.style.background = '#e74c3c';
        registerError.style.color = 'white';
        
        // Switch a login
        isLoginMode = true;
        loginForm.style.display = 'block';
        registerForm.style.display = 'none';
        loginSubtitle.textContent = 'Accedi per continuare';
        toggleText.innerHTML = 'Non hai un account? <a href="#" id="toggleLink">Registrati</a>';
        
        // Pre-compila username
        document.getElementById('username').value = username;
        document.getElementById('password').focus();
        
        // Ri-attacca evento
        document.getElementById('toggleLink').addEventListener('click', arguments.callee);
      }, 2000);
    });
    loginForm.addEventListener('submit', (e) => {
      e.preventDefault();
      
      const username = document.getElementById('username').value;
      const password = document.getElementById('password').value;

      // Cerca account nel database
      const account = findAccount(username, password);

      if (account) {
        console.log('âœ… Login effettuato con successo');
        console.log('ğŸ‘¤ Account:', account.nome, `(${account.ruolo})`);
        
        // Salva account corrente
        currentUser = account;
        
        // Aggiorna profilo con dati account
        profileUsername.textContent = account.username;
        document.querySelector('.profile-icon').textContent = account.avatar;
        document.querySelector('.profile-icon').style.background = account.colore;
        
        // Aggiorna info profilo
        const profileInfo = document.querySelector('.profile-info');
        profileInfo.innerHTML = `
          <div class="profile-item">
            <span>Username:</span>
            <strong>${account.username}</strong>
          </div>
          <div class="profile-item">
            <span>Nome:</span>
            <strong>${account.nome}</strong>
          </div>
          <div class="profile-item">
            <span>Email:</span>
            <strong>${account.email}</strong>
          </div>
          <div class="profile-item">
            <span>Ruolo:</span>
            <strong>${account.ruolo}</strong>
          </div>
          <div class="profile-item">
            <span>Registrato:</span>
            <strong>${new Date(account.dataRegistrazione).toLocaleDateString('it-IT')}</strong>
          </div>
          <div class="profile-item">
            <span>Ultimo accesso:</span>
            <strong id="lastLogin">${new Date().toLocaleString('it-IT')}</strong>
          </div>
        `;
        
        // Nascondi schermata login
        loginScreen.classList.add('hidden');
        
        // Mostra schermata principale dopo animazione
        setTimeout(() => {
          loginScreen.style.display = 'none';
          mainScreen.classList.add('active');
          
          // ğŸ†• INIZIALIZZA MAPPA DOPO LOGIN
          console.log('ğŸ—ºï¸ Avvio inizializzazione mappa...');
          setTimeout(() => {
            initializeMap();
          }, 100);
        }, 500);
        
      } else {
        console.log('âŒ Credenziali errate');
        
        // Mostra errore
        errorMessage.classList.add('show');
        
        // Nascondi errore dopo 3 secondi
        setTimeout(() => {
          errorMessage.classList.remove('show');
        }, 3000);
        
        // Resetta form
        document.getElementById('password').value = '';
      }
    });

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // GESTIONE SIDEBAR (Menu laterale)
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    // Apri sidebar quando clicchi hamburger
    hamburgerButton.addEventListener('click', () => {
      sidebar.classList.add('open');
      overlay.classList.add('active');
      console.log('ğŸ“‚ Sidebar aperta');
    });

    // Chiudi sidebar con X
    closeButton.addEventListener('click', closeSidebar);

    // Chiudi sidebar cliccando overlay
    overlay.addEventListener('click', closeSidebar);

    function closeSidebar() {
      sidebar.classList.remove('open');
      overlay.classList.remove('active');
      console.log('ğŸ“ Sidebar chiusa');
    }

    // Chiudi sidebar con tasto ESC
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape' && sidebar.classList.contains('open')) {
        closeSidebar();
      }
    });

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // GESTIONE LOGOUT CON RESET ACCOUNT
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    logoutButton.addEventListener('click', () => {
      if (confirm('Sei sicuro di voler uscire?')) {
        console.log('ğŸšª Logout effettuato');
        console.log('ğŸ‘‹ Arrivederci', currentUser ? currentUser.nome : '');
        
        // Chiudi sidebar
        closeSidebar();
        
        // PULISCI MAPPA
        if (map) {
          console.log('ğŸ§¹ Pulizia mappa...');
          if (avatarMarker) avatarMarker.remove();
          map.remove();
          map = null;
          avatarMarker = null;
          gpsTrackingActive = false;
        }
        
        // RESET ACCOUNT CORRENTE
        currentUser = null;
        
        // Nascondi schermata principale
        mainScreen.classList.remove('active');
        
        // Mostra schermata login
        setTimeout(() => {
          loginScreen.style.display = 'flex';
          loginScreen.classList.remove('hidden');
        }, 300);
        
        // Resetta form
        loginForm.reset();
        errorMessage.classList.remove('show');
      }
    });

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // RILEVAMENTO DISPOSITIVO E LOG DIMENSIONI
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    function detectDevice() {
      const width = window.innerWidth;
      const height = window.innerHeight;
      const isTouchDevice = 'ontouchstart' in window || navigator.maxTouchPoints > 0;
      const isLandscape = width > height;
      
      let deviceType = '';
      if (width >= 1441) deviceType = 'ğŸ–¥ï¸ Large Desktop';
      else if (width >= 1025) deviceType = 'ğŸ’» Desktop';
      else if (width >= 768) deviceType = 'ğŸ“± Tablet';
      else if (width >= 481) deviceType = 'ğŸ“± Mobile Landscape';
      else if (width >= 361) deviceType = 'ğŸ“± Mobile';
      else deviceType = 'ğŸ“± Mobile Small';
      
      console.group('ğŸ“ Info Dispositivo');
      console.log('Tipo:', deviceType);
      console.log('Schermo:', `${width}x${height}px`);
      console.log('Touch:', isTouchDevice ? 'SÃ¬' : 'No');
      console.log('Orientamento:', isLandscape ? 'Landscape' : 'Portrait');
      console.log('DPR:', window.devicePixelRatio);
      console.groupEnd();
      
      // Aggiorna classe body per debug
      document.body.setAttribute('data-device', deviceType);
      document.body.setAttribute('data-width', width);
    }

    // Esegui al caricamento
    detectDevice();

    // Esegui quando ridimensioni
    let resizeTimer;
    window.addEventListener('resize', () => {
      clearTimeout(resizeTimer);
      resizeTimer = setTimeout(() => {
        detectDevice();
        console.log('ğŸ”„ Finestra ridimensionata');
        if (map) map.resize(); // Ridimensiona mappa
      }, 250);
    });

    // Esegui quando cambi orientamento
    window.addEventListener('orientationchange', () => {
      setTimeout(() => {
        detectDevice();
        console.log('ğŸ”„ Orientamento cambiato');
        if (map) map.resize(); // Ridimensiona mappa
      }, 100);
    });

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // INIZIALIZZAZIONE MAPPA 3D
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    let map, tb, avatarModel, mixer, currentAnimation = null;
    let use3DAvatar = false;
    let avatarVisible = true;
    let currentLocation = null;
    let previousLocation = null;
    let smoothedLocation = null;
    let avatarMarker;
    let gpsTrackingActive = false;
    let movementTimeout;

    const CONFIG = {
      AVATAR_URL: 'https://models.readyplayer.me/688490fba5d9e1a75b930b7a.glb',
      AVATAR_FALLBACK_URL: 'https://models.readyplayer.me/688490fba5d9e1a75b930b7a.glb',
      AVATAR_SCALE: 5,
      AVATAR_HEIGHT: 1.8,
      GPS_ACCURACY_THRESHOLD: 100,
      GPS_MIN_MOVEMENT: 1,
      GPS_UPDATE_DISTANCE: 50,
      EMA_ALPHA: 0.25,
      TARGET_FPS: 60,
      ANIMATION_UPDATE_RATE: 1/60,
      IDLE_TIMEOUT: 1600,
      STATUS_AUTO_HIDE_DELAY: 2000,
      TRANSITION_DURATION: 1600,
      DEFAULT_HOME: [9.1900, 45.4642] // Milano
    };

    function initializeMap() {
      console.log('ğŸ—ºï¸ Inizializzazione mappa...');
      
      mapboxgl.accessToken = 'pk.eyJ1IjoibWVldGdvLWJ1aWxkMDAiLCJhIjoiY21jcTFzdXV2MGQ0MzJscXc0MHc0Y2Q0ZSJ9.hFWnqVLwck_EoyBZGoxdxA';

      map = new mapboxgl.Map({
        container: 'map',
        style: 'mapbox://styles/mapbox/streets-v12',
        zoom: 18,
        pitch: 60,
        bearing: 0,
        center: CONFIG.DEFAULT_HOME,
        antialias: true,
        maxTileCacheSize: 50,
        preserveDrawingBuffer: false,
        refreshExpiredTiles: false
      });

      // Controlli zoom
      document.getElementById('zoomIn').onclick = () => map.zoomIn();
      document.getElementById('zoomOut').onclick = () => map.zoomOut();
      document.getElementById('pitchSlider').addEventListener('input', (e) => {
        map.setPitch(parseInt(e.target.value, 10));
      });

      // Navigation control
      const navControl = new mapboxgl.NavigationControl({
        showCompass: true,
        showZoom: false
      });
      map.addControl(navControl, 'bottom-right');

      // Edifici 3D
      map.on('load', () => {
        console.log('âœ… Mappa caricata');
        
        const layers = map.getStyle().layers;
        let labelLayerId;
        for (const layer of layers) {
          if (layer.type === 'symbol' && layer.layout && layer.layout['text-field']) {
            labelLayerId = layer.id;
            break;
          }
        }

        map.addLayer({
          id: '3d-buildings',
          source: 'composite',
          'source-layer': 'building',
          filter: ['==', 'extrude', 'true'],
          type: 'fill-extrusion',
          minzoom: 15,
          paint: {
            'fill-extrusion-color': ['interpolate', ['linear'], ['get', 'height'], 0, '#aaa', 50, '#999', 100, '#888'],
            'fill-extrusion-height': ['get', 'height'],
            'fill-extrusion-base': ['get', 'min_height'],
            'fill-extrusion-opacity': 0.6
          }
        }, labelLayerId);

        map.setLight({
          anchor: 'map',
          color: '#ffffff',
          intensity: 0.5,
          position: [1.15, 210, 30]
        });

        // Inizializza GPS
        initializeGPS();
      });

      // Event listeners pulsanti
      document.getElementById('goHome').addEventListener('click', () => {
        const target = (gpsTrackingActive && smoothedLocation) ? smoothedLocation : CONFIG.DEFAULT_HOME;
        const zoom = (gpsTrackingActive && smoothedLocation) ? 18 : 12;
        const pitch = (gpsTrackingActive && smoothedLocation) ? 60 : 45;
        
        map.flyTo({ center: target, zoom, pitch, speed: 0.8, curve: 1.5 });
        setStatusMap('Centrato su posizione');
      });

      document.getElementById('avatarToggle').addEventListener('click', toggleAvatar3D);
      document.getElementById('buildingsToggle').addEventListener('click', toggleBuildings);
      document.getElementById('gpsToggle').addEventListener('click', toggleGPS);
      document.getElementById('visibilityToggle').addEventListener('click', toggleAvatarVisibility);

      console.log('âœ… Mappa inizializzata');
    }

    function setStatusMap(message, autoHide = true, duration = 2000) {
      const status = document.getElementById('statusIndicator');
      status.style.display = 'block';
      status.style.opacity = '1';
      status.textContent = message;
      
      if (autoHide) {
        setTimeout(() => {
          status.style.opacity = '0';
          setTimeout(() => status.style.display = 'none', 300);
        }, duration);
      }
    }

    function createAvatarMarker() {
      if (avatarMarker) {
        avatarMarker.remove();
        avatarMarker = null;
      }

      const el = document.createElement('div');
      el.className = 'avatar-marker';
      if (!avatarVisible) el.classList.add('avatar-hidden');
      
      avatarMarker = new mapboxgl.Marker(el)
        .setLngLat(smoothedLocation || CONFIG.DEFAULT_HOME)
        .addTo(map);
      
      console.log('âœ… Marker 2D creato');
    }

    function initializeGPS() {
      if (!navigator.geolocation) {
        console.warn('GPS non supportato');
        setStatusMap('GPS non supportato', true, 3000);
        createAvatarMarker();
        return;
      }

      navigator.geolocation.getCurrentPosition(
        (pos) => {
          const lng = pos.coords.longitude;
          const lat = pos.coords.latitude;
          
          console.log('âœ… GPS ottenuto:', { lng, lat });
          
          currentLocation = [lng, lat];
          previousLocation = [lng, lat];
          smoothedLocation = [lng, lat];
          
          map.flyTo({ 
            center: currentLocation, 
            zoom: 18, 
            pitch: 60, 
            duration: 1600 
          });
          
          createAvatarMarker();
          setStatusMap('Posizione GPS acquisita!');
          
          // Avvia tracking
          gpsTrackingActive = true;
        },
        (err) => {
          console.warn('Errore GPS:', err);
          setStatusMap('Usando posizione di default', true, 3000);
          createAvatarMarker();
        },
        { enableHighAccuracy: true, timeout: 8000, maximumAge: 5000 }
      );
    }

    function toggleGPS() {
      gpsTrackingActive = !gpsTrackingActive;
      const btn = document.getElementById('gpsToggle');
      
      if (gpsTrackingActive) {
        btn.classList.add('active');
        btn.textContent = 'ğŸ“ GPS ON';
        setStatusMap('GPS tracking attivo');
      } else {
        btn.classList.remove('active');
        btn.textContent = 'ğŸ“ GPS OFF';
        setStatusMap('GPS tracking disattivato');
      }
    }

    function toggleAvatarVisibility() {
      avatarVisible = !avatarVisible;
      const btn = document.getElementById('visibilityToggle');
      
      if (avatarVisible) {
        btn.textContent = 'ğŸ‘ï¸ Avatar ON';
        btn.classList.remove('hidden');
        if (avatarMarker) {
          avatarMarker.getElement().classList.remove('avatar-hidden');
        }
        setStatusMap('Avatar visibile');
      } else {
        btn.textContent = 'ğŸš« Avatar OFF';
        btn.classList.add('hidden');
        if (avatarMarker) {
          avatarMarker.getElement().classList.add('avatar-hidden');
        }
        setStatusMap('Avatar nascosto');
      }
    }

    function toggleAvatar3D() {
      use3DAvatar = !use3DAvatar;
      const btn = document.getElementById('avatarToggle');
      
      if (use3DAvatar) {
        btn.textContent = 'ğŸ‘¤ 3D';
        btn.style.background = '#4CAF50';
        btn.style.color = '#fff';
        setStatusMap('Avatar 3D attivato (demo)');
      } else {
        btn.textContent = 'ğŸ‘¤ 2D';
        btn.style.background = 'white';
        btn.style.color = 'black';
        setStatusMap('Avatar 2D attivo');
      }
    }

    let buildingsVisible = true;
    function toggleBuildings() {
      buildingsVisible = !buildingsVisible;
      const btn = document.getElementById('buildingsToggle');
      
      if (map.getLayer('3d-buildings')) {
        map.setLayoutProperty('3d-buildings', 'visibility', buildingsVisible ? 'visible' : 'none');
        btn.textContent = buildingsVisible ? 'ğŸ™ï¸ 3D On' : 'ğŸ™ï¸ 3D Off';
        setStatusMap(buildingsVisible ? 'Edifici 3D visibili' : 'Edifici 3D nascosti');
      }
    }

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // LOG INIZIALE CON LISTA ACCOUNT E INFO STORAGE
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    console.log('ğŸš€ App caricata');
    console.log('');
    
    // Mostra info storage
    storageInfo();
    console.log('');
    
    console.group('ğŸ‘¥ Account Disponibili');
    ACCOUNTS_DATABASE.forEach(account => {
      console.log(`${account.avatar} ${account.username} / ${account.password}`);
      console.log(`   â”œâ”€ Nome: ${account.nome}`);
      console.log(`   â”œâ”€ Ruolo: ${account.ruolo}`);
      console.log(`   â””â”€ Email: ${account.email}`);
    });
    console.groupEnd();
    
    console.log('');
    console.group('ğŸ› ï¸ Comandi Console Disponibili');
    console.log('showAccounts()     - Mostra tutti gli account in tabella');
    console.log('storageInfo()      - Info su storage e spazio usato');
    console.log('exportAccounts()   - Esporta backup JSON degli account');
    console.log('resetAccounts()    - âš ï¸ RESET a account default');
    console.log('createAccount(u,p) - Crea nuovo account da console');
    console.groupEnd();
    
    console.log('');
    console.log('ğŸ’¡ Credenziali: user / user123');
    detectDevice();
  </script>

</body>
</html>
